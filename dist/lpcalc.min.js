function LPCalc(a){this.d=document,this.init(a)}LPCalc.prototype.init=function(a){this.r=document.querySelector(a),this.valueHistory=[],this.currentValue=0,this.inputValue=null,this.opStatus=null,this.build()},LPCalc.prototype.build=function(){this.createValue().createControls().initOperations()},LPCalc.prototype.createValue=function(){this.r.className+=" lpcalc";var a=null!==this.r.querySelector('[data-calc-history="true"]'),b=null!==this.r.querySelector('[data-calc-input="true"]');if(0==a||0==b){var c=this.d.createElement("div");if(c.className="val",c.setAttribute("id","valueDiv"),0==a){var d=this.d.createElement("div");d.className="val-history",d.setAttribute("data-calc-history","true"),c.appendChild(d)}if(0==b){var e=this.d.createElement("input");e.setAttribute("type","text"),e.setAttribute("id","valInput"),e.placeholder=0,e.setAttribute("data-calc-input","true"),c.appendChild(e)}this.r.appendChild(c)}return this.historyField=this.r.querySelector('[data-calc-history="true"]'),this.valueField=this.r.querySelector('[data-calc-input="true"]'),this},LPCalc.prototype.createControls=function(){var a=null!==this.r.querySelector('[data-controls="true"]'),b=null!==this.r.querySelector('[data-operations="true"]'),c=null!==this.r.querySelector('[data-numpad="true"]'),d=[["add","+"],["sub","-"],["mul","x"],["div","/"],["exp","x<sup>y</sup>","^"],["clr","c"],["res","="]];for(0==b&&(b=this.d.createElement("ul"),b.className="ops",b.append=!0),b.setAttribute("data-operations","true"),i=0;i<d.length;i+=1){var e=null!==this.r.querySelector('[data-operation="'+d[i][0]+'"]');if(0==e){var f=this.d.createElement("li");f.className=d[i][0];var g=this.d.createElement("button");g.setAttribute("type","button"),g.className="op-btn",g.setAttribute("data-operation",d[i][0]),g.setAttribute("data-op-signal",void 0!==d[i][2]?d[i][2]:d[i][1]),g.innerHTML=d[i][1],f.appendChild(g),b.appendChild(f)}else e.setAttribute("data-operation",d[i][0])}for(0==c&&(c=this.d.createElement("ul"),c.className="numPad",c.append=!0),c.setAttribute("data-numpad","true"),i=0;i<10;i+=1){var e=null!==this.r.querySelector('[data-digit="'+(9-i)+'"');if(0==e){var h=this.d.createElement("li");h.className="num n-"+(9-i);var g=this.d.createElement("button");g.setAttribute("type","button"),g.className="num-btn",g.setAttribute("data-digit",9-i),g.innerHTML=9-i,h.appendChild(g),c.appendChild(h)}}var e=null!==this.r.querySelector('[data-digit="."');if(0==e){var h=this.d.createElement("li");h.className="num n-dot";var g=this.d.createElement("button");g.setAttribute("type","button"),g.className="num-btn",g.setAttribute("data-digit","."),g.innerHTML=".",h.appendChild(g),c.appendChild(h)}if(0==a){var j=this.d.createElement("nav");j.setAttribute("id","ctrl"),j.className="ctrl",j.setAttribute("data-controls","true"),1==b.append&&j.appendChild(b),1==c.append&&j.appendChild(c),this.r.appendChild(j)}else 1==b.append&&j.appendChild(b),1==c.append&&j.appendChild(c);return this.controls=this.r.querySelector('[data-calc-controls="true"]'),this.operations=d,this.digits=this.r.querySelectorAll("[data-digit]"),this},LPCalc.prototype.initOperations=function(){for(self=this,i=0;i<self.operations.length;i+=1)self.r.querySelector('[data-operation="'+self.operations[i][0]+'"]').onclick=function(a){a.preventDefault(),self.doOperation(this.getAttribute("data-operation"),this.getAttribute("data-op-signal"))};for(i=0;i<self.digits.length;i+=1)self.digits[i].onclick=function(a){a.preventDefault(),self.addDigit(this.getAttribute("data-digit"))};return self.r.onkeypress=function(a){switch(a.preventDefault(),a.charCode){case 43:self.doOperation("add");break;case 45:self.doOperation("sub");break;case 42:self.doOperation("mul");break;case 47:self.doOperation("div");break;case 121:self.doOperation("exp");break;case 61:a.preventDefault(),self.doOperation("res");break;default:switch(a.charCode>=48&&a.charCode<=57&&self.addDigit(a.key),44!=a.charCode&&46!=a.charCode||null==self.valueField.value.match(/[\.\,]/g)&&self.addDigit(a.key),a.keyCode){case 13:case 61:a.preventDefault(),self.doOperation("res")}}},this},LPCalc.prototype.addDigit=function(a){self.valueField.value+=a,self.valueField.setAttribute("data-ready","true")},LPCalc.prototype.doOperation=function(a,b){if("clr"==a)return self.valueHistory=[],self.historyField.innerHTML="",self.currentValue=0,self.optStatus=null,self.inputValue=null,self.valueField.placeholder=self.currentValue,self.valueField.value="",self.valueField.removeAttribute("data-ready"),!1;if(void 0!==self.valueField.getAttribute("data-ready")){if(null==self.optStatus)return self.optStatus="res"==a?null:a,self.opSignal=b,self.currentValue=void 0==self.valueField.getAttribute("data-ready")?self.currentValue:Number(self.valueField.value.replace(/,/g,".")),self.valueField.placeholder=self.currentValue,self.valueField.value="",self.valueField.removeAttribute("data-ready"),!1;switch(self.inputValue=Number(self.valueField.value.replace(/,/g,".")),self.valueHistory.push([self.currentValue,self.optStatus,self.inputValue]),self.historyField.innerHTML=""==self.historyField.innerHTML?self.currentValue:self.historyField.innerHTML,self.historyField.innerHTML=self.historyField.innerHTML+" <span class='op'>"+self.opSignal+"</span> "+self.inputValue,self.optStatus){case"add":self.currentValue=self.currentValue+self.inputValue;break;case"sub":self.currentValue=self.currentValue-self.inputValue;break;case"mul":self.currentValue=self.currentValue*self.inputValue;break;case"div":self.currentValue=self.currentValue/self.inputValue;break;case"exp":self.currentValue=Math.pow(self.currentValue,self.inputValue);break;default:self.historyField.innerHTML=""}self.optStatus=null,self.inputValue=null,self.valueField.placeholder=self.currentValue,self.valueField.value="",self.valueField.removeAttribute("data-ready")}else self.optStatus="res"==a?null:a,self.opSignal=b,self.currentValue=void 0==self.valueField.getAttribute("data-ready")?self.currentValue:Number(self.valueField.value.replace(/,/g,"."))};